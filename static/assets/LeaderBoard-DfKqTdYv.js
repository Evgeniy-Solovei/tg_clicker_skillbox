import{g as R,r as d,j as e,e as M,u as T}from"./index-C9h0uLkK.js";import{u as Y}from"./useQuery-Dt9R8wZp.js";import{a as q,L as Z,P as z}from"./PageUI-w6JRTVFj.js";import{a as B,b as D,q as U}from"./queryClient-B3yILKih.js";import{g as K}from"./getUser-DJBpJkua.js";import{i as F}from"./coin-DlK3Y3AM.js";function G(t){return B.get(`${D}/api/top100/${t}/`).then(a=>a.data).catch(a=>{console.log(a)})}const Q="_leader__section_d37jh_1",V="_leader__title_d37jh_6",A="_page__list_d37jh_16",f={leader__section:Q,leader__title:V,page__list:A},J="_slidingPanel_7nivp_1",W="_sliding_7nivp_1",X="_dragZone_7nivp_25",ee="_dragHandle_7nivp_32",ne="_overlay_7nivp_44",te="_panelContent_7nivp_53",ae="_darkened_7nivp_58",se="_visible_7nivp_66",ie="_expanded_7nivp_71",oe="_bodyOpen_7nivp_75",r={slidingPanel:J,sliding:W,dragZone:X,dragHandle:ee,overlay:ne,panelContent:te,darkened:ae,visible:se,expanded:ie,bodyOpen:oe};function re(t,a={},s=[]){return[t,...s.filter(Boolean),...Object.entries(a).filter(([i])=>!!i).map(([i])=>i)].join(" ")}function de(t){const{children:a,element:s=document.body}=t;return R.createPortal(a,s)}function le(t){const{initialHeight:a,fullHeight:s,children:i,isOpen:n,onClose:o,darkened:c,className:C="",lazy:w,scrollLock:H}=t,[m,u]=d.useState("0"),j=d.useRef(null),y=d.useRef(0),x=d.useRef(0),g=d.useRef(),v=d.useRef(null),[O,P]=d.useState(!1),$=_=>{y.current=_.touches[0].clientY,x.current=parseInt(m),document.addEventListener("touchmove",b),document.addEventListener("touchend",h)},b=_=>{const k=y.current-_.touches[0].clientY,E=x.current+k;k>0?v.current="up":v.current="down",E>=parseInt(s)?u(s):E<=parseInt(a)&&u(a)},h=()=>{document.removeEventListener("touchmove",b),document.removeEventListener("touchend",h),parseInt(m)<=parseInt(a)&&v.current==="down"&&(u("0"),o&&(g.current=setTimeout(()=>{o()},300)))},N=_=>{_.key==="Escape"&&n&&o&&(g.current=setTimeout(()=>{o()},300))},L=()=>{n&&o&&(g.current=setTimeout(()=>{o()},300))},I=_=>{c&&_.target===j.current&&o()};d.useEffect(()=>(n&&(document.body.classList.add(r.bodyOpen),u(a),document.addEventListener("keydown",N),window.addEventListener("popstate",L)),()=>{clearTimeout(g.current),document.body.classList.remove(r.bodyOpen),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",h),document.removeEventListener("keydown",N),window.removeEventListener("popstate",L)}),[n]);const S={[r.visible]:n,[r.darkened]:n?c:!1};return d.useEffect(()=>{n&&P(!0)},[n]),w&&!O?null:e.jsx(de,{children:e.jsx("div",{ref:j,className:re(r.slidingPanel,S,["app_modal",C]),onClick:I,style:c?{}:{height:n?m:"0",bottom:n?"0":`-${s}`,transition:"height 0.3s ease"},children:e.jsx("div",{className:r.sliding,style:c?{height:n?m:"0",bottom:n?"0":`-${s}`,transition:"height 0.3s ease"}:{},children:e.jsxs("div",{className:r.overlay,style:m==="50%"&&H?{overflowY:"hidden"}:{overflowY:"scroll"},children:[e.jsx("div",{onTouchStart:$,className:r.dragZone,children:e.jsx("div",{className:r.dragHandle})}),e.jsx("div",{className:r.panelContent,children:i})]})})})})}const _e="/assets/sliding__prize-B9vwOjVE.png",ce="_sliding__image_1vcyf_1",me="_sliding__title_1vcyf_5",ue="_sliding__label_1vcyf_15",ge="_sliding__button_1vcyf_24",p={sliding__image:ce,sliding__title:me,sliding__label:ue,sliding__button:ge},pe=({initialHeight:t,fullHeight:a,isOpen:s,onClose:i})=>e.jsxs(le,{initialHeight:t,fullHeight:a,isOpen:s,onClose:i,children:[e.jsx("img",{className:p.sliding__image,src:_e,alt:""}),e.jsx("h3",{className:p.sliding__title,children:"Супер-приз ждет тебя!"}),e.jsx("p",{className:p.sliding__label,children:"15 декабря игрок, который наберет наибольшее количество баллов, получит супер-приз — iPhone 16!"}),e.jsx("button",{onClick:i,className:p.sliding__button,children:"Ура!"})]}),ve="_leaderboard__item_cj08m_1",be="_back_cj08m_9",he="_leaderboard__avatar_cj08m_13",fe="_leaderboard__name_cj08m_19",je="_leaderboard__coins_cj08m_26",ye="_iconCoin_cj08m_33",xe="_leaderboard__index_cj08m_38",Ne="_leaderboard__svg_cj08m_45",l={leaderboard__item:ve,back:be,leaderboard__avatar:he,leaderboard__name:fe,leaderboard__coins:je,iconCoin:ye,leaderboard__index:xe,leaderboard__svg:Ne},Le=({id:t,name:a,points:s,index:i})=>e.jsxs("li",{className:i<=3?`${l.back} ${l.leaderboard__item}`:l.leaderboard__item,children:[e.jsx("span",{className:l.leaderboard__index,children:i}),e.jsx("img",{className:l.leaderboard__avatar,src:q,alt:"avatar"}),i===1&&e.jsx(Z,{className:l.leaderboard__svg}),e.jsx("h2",{className:l.leaderboard__name,children:a}),e.jsx("p",{className:l.leaderboard__coins,children:s}),e.jsx("img",{className:l.iconCoin,src:F,alt:""})]},t),Pe=()=>{const t=M(K),{tg_id:a}=T(),[s,i]=d.useState(!1),{data:n}=Y({queryFn:()=>G(a),queryKey:["leaderboard"]},U);return e.jsxs(z,{className:f.leader__section,className__title:f.leader__title,place:n==null?void 0:n.player_rank,name:t==null?void 0:t.name,coins:t==null?void 0:t.points_all,gift:1,title:"Leaderboard",time:"До конца осталось: 12 дней 8 часов",isOpen:()=>i(!0),children:[e.jsx("ul",{className:f.page__list,children:n==null?void 0:n.top_players.map((o,c)=>e.jsx(Le,{index:c+1,id:o.tg_id,name:o.name,points:o.points},o.tg_id))}),e.jsx(pe,{fullHeight:"70",initialHeight:"30",isOpen:s,onClose:()=>i(!1)})]})};export{Pe as default};
