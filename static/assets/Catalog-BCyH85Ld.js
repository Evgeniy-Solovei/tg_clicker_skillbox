import{u as N,j as s,r as j,e as v,b as P}from"./index-CNzmFJnI.js";import{i as w,u as $}from"./coin-BEzBEEHb.js";import{a as F,b as O,q as H}from"./queryClient-B4yZ_JS7.js";import{u as M}from"./useMutation-DgyhIzYf.js";import{S as q}from"./SlidingPanel-CWJF48FL.js";import{l as D}from"./logo-exXQDy5k.js";import{H as E}from"./HeaderCoinSvg-fnDQnBK5.js";import{g as S}from"./getUser-DJBpJkua.js";const T="_catalog__section_uqf9l_1",X="_catalog__header_uqf9l_6",G="_reverse_uqf9l_15",L="_catalog__button_uqf9l_33",Q="_catalog__image_uqf9l_42",R="_catalog__list_uqf9l_48",U="_category__caption_uqf9l_53",Y="_catalog__title_uqf9l_79",K="_catalog__info1_uqf9l_88",W="_info__title_uqf9l_101",Z="_info__label_uqf9l_109",o={catalog__section:T,catalog__header:X,reverse:G,catalog__button:L,catalog__image:Q,catalog__list:R,category__caption:U,catalog__title:Y,catalog__info1:K,info__title:W,info__label:Z};function A(e){return F.get(`${O}/api/shop/product-list/${e}/`,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}}).then(i=>i.data).catch(i=>{console.log(i)})}function J(e,i){return F.post(`${O}/api/shop/product-list/${e}/`,{product_id:i}).then(t=>t.data).catch(t=>{console.log(t)})}const V="_catalog__item_1lzem_1",I="_catalog__upper_1lzem_19",ss="_catalog__price_1lzem_24",is="_catalog__info_1lzem_34",as="_catalog__down_1lzem_48",ts="_catalog__img_1lzem_54",es="_catalog__profession_1lzem_63",ns="_catalog__prof_1lzem_63",_s="_catalog_compl_btn_1lzem_87",m={catalog__item:V,catalog__upper:I,catalog__price:ss,catalog__info:is,catalog__down:as,catalog__img:ts,catalog__profession:es,catalog__prof:ns,catalog_compl_btn:_s},cs="/assets/iconBook-Dt4xzM-P.png",ls="/assets/sale5-BHXnLRWG.png",os="/assets/sale10-DNBte8BQ.png",x="/assets/useful_materials-Cfmv-Iql.png",k="/assets/miniCurs-DjvlySZB.png",rs="/assets/iconMerch-BICvc0cD.png",gs=(e,i)=>{switch(e){case"Пройдите профтест на ....":return i(cs);case"Cкидка 5% на все курсы":return i(ls);case"Cкидка 10% на все курсы":return i(os);case"Python-разработчик":return i(x);case"Бизнес-аналитик":return i(x);case"Веб-дизайнер":return i(x);case"40 правил идеального текста для соцсетей":return i(x);case"Как найти клиентов фрилансеру":return i(x);case"Введение в программирование":return i(k);case"Введение в маркетинг":return i(k);case"Введение в дизайн":return i(k);case"Эксклюзивная байка":return i(rs)}},ds=e=>{if(typeof e=="number")return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},ms="_sliding__block_15i9u_1",ps="_name_title_15i9u_14",us="_name_title_not_15i9u_23",hs="_sliding_product_btn_buy_15i9u_33",fs="_promo_15i9u_48",bs="_sliding_product_btn_promo_15i9u_58",g={sliding__block:ms,name_title:ps,name_title_not:us,sliding_product_btn_buy:hs,promo:fs,sliding_product_btn_promo:bs};function xs({isOpen:e,onClose:i,initialHeight:t,fullHeight:d,product:a}){const{tg:c,tg_id:h}=N(),p=M({mutationFn:n=>J(n.tg_id,n.product_id),onSuccess:n=>{n.message==="Продукт успешно куплен"&&(window.location.href=a.link,c.HapticFeedback.impactOccurred("medium"))},onError:()=>{i(),c.HapticFeedback.impactOccurred("medium")}},H),l=()=>{p.mutate({tg_id:h,product_id:a.id}),c.HapticFeedback.impactOccurred("medium")},f=()=>{if(!a.is_accessible)p.mutate({tg_id:h,product_id:a.id}),c.HapticFeedback.impactOccurred("medium");else return},b=()=>{navigator.clipboard.writeText("555"),c.HapticFeedback.impactOccurred("heavy")};return s.jsx(q,{darkened:!0,isOpen:e,onClose:i,initialHeight:t,fullHeight:d,children:s.jsxs("div",{className:g.sliding__block,children:[a.currentCoin&&a.price!==0&&a.currentCoin>=+a.price?s.jsxs(s.Fragment,{children:[a.id=="4"||a.id=="5"?s.jsxs("p",{className:g.promo,children:[a.id=="4"&&"BOXY5",a.id=="5"&&"BOXY10"]}):null,s.jsx("p",{className:g.name_title,children:a.name}),a.id=="4"||a.id=="5"?s.jsx("button",{onClick:b,className:g.sliding_product_btn_promo,children:"Скопировать промокод"}):null,s.jsx("button",{onClick:f,className:a.id=="4"||a.id=="5"?g.sliding_product_btn_promo:g.sliding_product_btn_buy,children:a.id=="4"||a.id=="5"?"Активировать":"Купить"})]}):a.price!==0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:g.name_title_not,children:"Недостаточно баллов!"}),s.jsx("img",{width:60,src:w,alt:""}),s.jsx("button",{onClick:()=>i(),className:g.sliding_product_btn_buy,children:"Назад"})]}),a.price===0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:g.name_title,children:a.name}),s.jsx("button",{onClick:l,className:g.sliding_product_btn_buy,children:"Пройти"})]})]})})}const C=({id:e,name:i,price:t,description:d,prof:a,link:c,currentCoin:h,is_accessible:p,is_purchased:l})=>{const{tg:f}=N(),[b,n]=j.useState(),_={id:e,name:i,price:t,description:d,prof:a,is_accessible:p,link:c,currentCoin:h,is_purchased:l},[r,y]=j.useState(!1);j.useEffect(()=>{gs(i,n)},[i]);const B=()=>{p||(y(!0),f.HapticFeedback.impactOccurred("medium"))},z=()=>{y(!1),f.HapticFeedback.impactOccurred("medium")};return s.jsxs(s.Fragment,{children:[s.jsxs("li",{onClick:B,className:m.catalog__item,children:[s.jsxs("div",{className:m.catalog__upper,children:[l?s.jsx("button",{disabled:!0,className:m.catalog_compl_btn,children:"Приобретено"}):s.jsxs("p",{style:{display:"flex",alignItems:"center",gap:"8px"},className:m.catalog__price,children:[t===0&&"Бесплатно",t!==0&&s.jsx("img",{width:43,height:43,src:w,alt:"coin"}),t!==0&&ds(t)]}),t!==0&&s.jsx("p",{className:m.catalog__prof,children:a}),s.jsx("h2",{className:m.catalog__info,children:i})]}),s.jsx("span",{className:m.catalog__profession,children:d}),s.jsx("img",{className:m.catalog__img,src:b,alt:"предмет каталога"})]},e),s.jsx(xs,{onClose:z,isOpen:r,initialHeight:"70%",fullHeight:"70vh",product:_})]})},js="_sliding__button_1fcgw_1",Ns="_sliding__block_1fcgw_10",ks="_sliding__image_1fcgw_23",ys="_sliding__title_1fcgw_27",Cs="_sliding__label_1fcgw_35",vs="_sliding__span_1fcgw_46",ws="_sliding__money_1fcgw_55",Fs="_sliding__coins_1fcgw_61",u={sliding__button:js,sliding__block:Ns,sliding__image:ks,sliding__title:ys,sliding__label:Cs,sliding__span:vs,sliding__money:ws,sliding__coins:Fs},Os="/assets/sliding__catalog-d19G_n9M.webp",Hs=({isOpen:e,onClose:i,initialHeight:t,fullHeight:d})=>{const a=v(S),{tg:c}=N();return s.jsx(q,{darkened:!0,isOpen:e,onClose:i,initialHeight:t,fullHeight:d,children:s.jsxs("div",{className:u.sliding__block,children:[s.jsxs("div",{className:u.sliding__money,children:[s.jsx("img",{width:277,height:90,src:Os,alt:""}),s.jsx("span",{className:u.sliding__coins,children:a==null?void 0:a.points_all})]}),s.jsx("h2",{className:u.sliding__title,children:"У тебя есть баллы!"}),s.jsx("p",{className:u.sliding__label,children:"Обменяй их на бонусы в нашем магазине"}),s.jsx("p",{className:u.sliding__span,children:"*Важно: когда ты тратишь баллы в магазине, твой рейтинг в лидерборде не меняется!"}),s.jsx("button",{onClick:()=>{i(),c.HapticFeedback.impactOccurred("medium")},className:u.sliding__button,children:"Понятно"})]})})},Es=()=>{const{tg:e,tg_id:i}=N(),t=v(S),[d,a]=j.useState(!1),c=P(),h=()=>{a(!1),e.HapticFeedback.impactOccurred("medium")},p=()=>{a(!0),e.HapticFeedback.impactOccurred("medium")},{data:l}=$({queryFn:()=>A(i),queryKey:["catalog"]},H),b=["Каталог","Скидки","Полезные материалы","Мини-курсы","Мерч"].filter(n=>n!=="Каталог");return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:o.catalog__section,children:[s.jsxs("div",{className:o.catalog__header,children:[s.jsx("button",{onClick:p,className:o.catalog__button,children:"Информация"}),s.jsx("img",{width:69,height:15,className:o.catalog__image,src:D,alt:""}),s.jsxs("p",{onClick:()=>c("/tasks"),className:o.reverse,children:[s.jsx("span",{children:t==null?void 0:t.points}),s.jsx(E,{})]})]}),s.jsx("h1",{className:o.catalog__title,children:"Каталог"}),s.jsxs("div",{className:o.catalog__info1,children:[s.jsx("h2",{className:o.info__title,children:"Тапай и копи баллы!"}),s.jsx("p",{className:o.info__label,children:"Чтобы выиграть IPhone или получить мерч"})]}),s.jsxs("ul",{className:o.catalog__list,children:[l==null?void 0:l.shops.filter(n=>n.name==="Каталог").map(n=>n.products.map(_=>s.jsx(C,{prof:_.description,id:_.id,name:_.name,link:_.link,currentCoin:t==null?void 0:t.points,price:_.price,description:n.description,is_accessible:_.is_accessible,is_purchased:_.is_purchased},_.id))),b.map(n=>s.jsxs(j.Fragment,{children:[s.jsx("li",{style:{margin:"30px 0"},children:s.jsx("h2",{className:o.category__caption,children:n})}),l==null?void 0:l.shops.filter(_=>_.name===n).map(_=>_.products.map(r=>s.jsx(C,{id:r.id,currentCoin:t==null?void 0:t.points,name:r.name,price:r.price,prof:r.description,description:_.description,link:r.link,is_accessible:r.is_accessible,is_purchased:r.is_purchased},r.id)))]},n))]})]}),s.jsx(Hs,{fullHeight:"70vh",initialHeight:"70%",isOpen:d,onClose:h})]})};export{Es as default};
