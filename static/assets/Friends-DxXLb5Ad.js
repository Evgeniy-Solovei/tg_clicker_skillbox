import{u as j,j as e,r as d}from"./index-rbZjz3ed.js";import{a as q,P as y}from"./PageUI-FKKrtzYV.js";import{u as x}from"./useQuery-BObk5xUY.js";import{b as F,c as S,f as w}from"./fetchFriends-BBFXaZJa.js";import{q as g}from"./queryClient-BMR_gP-p.js";import{u as C}from"./useMutation-CzJk5Uro.js";import{H as v}from"./HeaderCoinSvg-wUf429Zw.js";import{S as D}from"./SlidingPanel-B2y0OtZd.js";import{f as H}from"./friends__invite-Ds21nNo3.js";import"./coin-DlK3Y3AM.js";const L="_friends__section_9k5ar_1",$="_friends__title_9k5ar_6",E="_friends__invite_9k5ar_10",O="_invite__title_9k5ar_23",R="_invite__label_9k5ar_31",T="_invite__button_9k5ar_39",I="_page__list_9k5ar_50",a={friends__section:L,friends__title:$,friends__invite:E,invite__title:O,invite__label:R,invite__button:T,page__list:I},P="_friends__item_3q1nm_1",U="_friends__position_3q1nm_19",A="_friends__avatar_3q1nm_33",K="_friends__info_3q1nm_45",M="_friends__name_3q1nm_57",Q="_friends__coins_3q1nm_69",z="_icon_coin_3q1nm_81",B="_friends__button_3q1nm_93",Y="_friends_reg_data_3q1nm_121",t={friends__item:P,friends__position:U,friends__avatar:A,friends__info:K,friends__name:M,friends__coins:Q,icon_coin:z,friends__button:B,friends_reg_data:Y};function G(i){const s=new Date(i),n=String(s.getUTCDate()).padStart(2,"0"),_=String(s.getUTCMonth()+1).padStart(2,"0"),l=String(s.getUTCFullYear()).slice(-2);return`${n}.${_}.${l}`}function f({friends:i,index:s,isOpen:n,isDisabled:_}){const{tg:l,tg_id:u}=j(),p=C({mutationFn:r=>F(r.tg_id,r.new_player_id),onSuccess:()=>{g.invalidateQueries({queryKey:["friends"]}),n&&n(!0)},onError:r=>{console.log(r)}},g),c=()=>{p.mutate({tg_id:u,new_player_id:i.tg_id}),l.HapticFeedback.impactOccurred("light")};return e.jsxs("li",{className:t.friends__item,children:[e.jsx("span",{className:t.friends__position,children:s+1}),e.jsx("img",{className:t.friends__avatar,src:q,alt:"avatar"}),e.jsxs("div",{className:t.friends__info,children:[e.jsx("p",{className:t.friends__name,children:i==null?void 0:i.name}),e.jsxs("div",{className:t.icon_coin,children:[e.jsx(v,{width:"12",height:"12"}),e.jsx("p",{className:t.friends__coins,children:i==null?void 0:i.points})]})]}),i.referral_bonus?e.jsx("button",{disabled:_,onClick:c,className:t.friends__button,children:"Забрать награду"}):e.jsxs("span",{className:t.friends_reg_data,children:["Приглашён ",G(i.reg_data)]})]})}const J="_sliding__button_qswlm_1",V="_sliding__block_qswlm_8",W="_sliding__image_qswlm_20",X="_sliding__title_qswlm_24",Z="_sliding__label_qswlm_32",o={sliding__button:J,sliding__block:V,sliding__image:W,sliding__title:X,sliding__label:Z},ee=({isOpen:i,onClose:s,fullHeight:n,initialHeight:_})=>e.jsx(D,{initialHeight:_,fullHeight:n,darkened:!0,isOpen:i,onClose:s,children:e.jsxs("div",{className:o.sliding__block,children:[e.jsx("img",{className:o.sliding__image,width:215,height:215,src:H,alt:""}),e.jsx("h2",{className:o.sliding__title,children:"Твоя награда:"}),e.jsxs("p",{className:o.sliding__label,children:[e.jsx(v,{}),e.jsx("span",{children:"500"})]}),e.jsx("button",{onClick:s,className:o.sliding__button,children:"Ура!"})]})});function ce(){const{tg:i,tg_id:s}=j(),[n,_]=d.useState([]),[l,u]=d.useState(""),[p,c]=d.useState(!1),r=()=>{c(!1)},k=()=>{const m=`https://t.me/share/url?url=${l}`;i.openTelegramLink(m),i.HapticFeedback.impactOccurred("light")},h=x({queryKey:["refLink"],queryFn:()=>S(s)},g),{data:b}=x({queryKey:["friends"],queryFn:()=>w(s)},g);return d.useEffect(()=>{h.data&&u(h.data.ref_link)},[h]),d.useEffect(()=>{b&&_(b)},[b]),e.jsxs(e.Fragment,{children:[e.jsxs(y,{className:a.friends__section,className__title:a.friends__title,title:"Друзья",children:[e.jsxs("div",{className:a.friends__invite,children:[e.jsx("h2",{className:a.invite__title,children:"Играть вместе веселее!"}),e.jsx("p",{className:a.invite__label,children:"Получай награды за каждого друга, который присоединился"}),e.jsx("button",{className:a.invite__button,onClick:k,children:"Пригласить друга"})]}),e.jsxs("ul",{className:a.page__list,children:[n.map((m,N)=>e.jsx(f,{isOpen:c,friends:m,index:N,isDisabled:!1},m.tg_id)),n.length===0&&e.jsxs(e.Fragment,{children:[e.jsx(f,{friends:{name:"Name",points:"1.2kk",reg_data:"10.10.24",referral_bonus:!0,tg_id:"654651"},isDisabled:!0,index:0})," ",e.jsx(f,{friends:{name:"Name",points:"1.2kk",reg_data:"10.10.24",referral_bonus:!1,tg_id:"654651"},isDisabled:!0,index:1})," ",e.jsx(f,{friends:{name:"Name",points:"1.2kk",reg_data:"10.10.24",referral_bonus:!1,tg_id:"654651"},isDisabled:!0,index:2})]})]})]}),e.jsx(ee,{isOpen:p,onClose:r,initialHeight:"70%",fullHeight:"70vh"})]})}export{ce as default};
