import{u as x,j as i,r as c}from"./index-BXvIbvR9.js";import{a as v,P as N}from"./avatar-CRWdlj5_.js";import{b as q,H as y,u as F,f as C,c as H}from"./fetchFriends-CHeEiXVP.js";import{u as S}from"./useSuspenseQuery-DMwfkl0o.js";import{i as O,q as g}from"./coin-C4NZrf3P.js";import{u as L}from"./useMutation-KymNvUJE.js";import{S as D}from"./SlidingPanel-DUq-jg5e.js";import{f as R}from"./friends__invite-Ds21nNo3.js";import"./formatNumber-B2gvpCqi.js";import"./useBaseQuery-Y2aCGemD.js";const w="_friends__section_1kllm_1",E="_friends__title_1kllm_6",I="_friends__invite_1kllm_10",P="_invite__title_1kllm_23",A="_invite__label_1kllm_31",K="_invite__button_1kllm_39",Q="_page__list_1kllm_50",t={friends__section:w,friends__title:E,friends__invite:I,invite__title:P,invite__label:A,invite__button:K,page__list:Q},$="_friends__item_3q1nm_1",T="_friends__position_3q1nm_19",z="_friends__avatar_3q1nm_33",B="_friends__info_3q1nm_45",M="_friends__name_3q1nm_57",U="_friends__coins_3q1nm_69",G="_icon_coin_3q1nm_81",J="_friends__button_3q1nm_93",V="_friends_reg_data_3q1nm_121",s={friends__item:$,friends__position:T,friends__avatar:z,friends__info:B,friends__name:M,friends__coins:U,icon_coin:G,friends__button:J,friends_reg_data:V};function f({friends:e,index:n,isOpen:_,isDisabled:l}){const{tg:a,tg_id:u}=x(),p=L({mutationFn:o=>q(o.tg_id,o.new_player_id),onSuccess:()=>{g.invalidateQueries({queryKey:["friends"]}),_&&(_(!0),a.HapticFeedback.impactOccurred("light"))}},g),d=()=>{p.mutate({tg_id:u,new_player_id:e.tg_id}),a.HapticFeedback.impactOccurred("light")};return i.jsxs("li",{className:s.friends__item,children:[i.jsx("span",{className:s.friends__position,children:n+1}),i.jsx("img",{className:s.friends__avatar,src:v,alt:"avatar"}),i.jsxs("div",{className:s.friends__info,children:[i.jsx("p",{className:s.friends__name,children:e==null?void 0:e.name}),i.jsxs("div",{className:s.icon_coin,children:[i.jsx("img",{width:12,height:12,className:s.iconCoin,src:O,alt:""}),i.jsx("p",{className:s.friends__coins,children:e.points="1.2kk"})]})]}),e.referral_bonus?i.jsx("button",{disabled:l,onClick:d,className:s.friends__button,children:"Забрать награду"}):i.jsxs("span",{className:s.friends_reg_data,children:["Приглашён"," ",e.reg_data="10.10.24"]})]})}const W="_sliding__button_1ialg_1",X="_sliding__block_1ialg_15",Y="_sliding__image_1ialg_28",Z="_sliding__title_1ialg_32",ii="_sliding__label_1ialg_40",ei="_count_coin_1ialg_51",r={sliding__button:W,sliding__block:X,sliding__image:Y,sliding__title:Z,sliding__label:ii,count_coin:ei},si=({isOpen:e,onClose:n,fullHeight:_,initialHeight:l})=>{const{tg:a}=x();return i.jsx(D,{initialHeight:l,fullHeight:_,darkened:!0,isOpen:e,onClose:n,children:i.jsxs("div",{className:r.sliding__block,children:[i.jsx("img",{className:r.sliding__image,width:215,height:215,src:R,alt:""}),i.jsx("h2",{className:r.sliding__title,children:"Твоя награда:"}),i.jsxs("p",{className:r.sliding__label,children:[i.jsx(y,{}),i.jsx("span",{className:r.count_coin,children:"500"})]}),i.jsx("button",{onClick:()=>{n(),a.HapticFeedback.impactOccurred("light")},className:r.sliding__button,children:"Ура!"})]})})};function fi(){const{tg:e,tg_id:n}=x(),[_,l]=c.useState([]),[a,u]=c.useState(""),[p,d]=c.useState(!1),o=()=>{d(!1),e.HapticFeedback.impactOccurred("light")},k=()=>{const m=`https://t.me/share/url?url=${a}`;e.openTelegramLink(m),e.HapticFeedback.impactOccurred("light")},h=F({queryKey:["refLink"],queryFn:()=>H(n)},g),{data:b}=S({queryKey:["friends"],queryFn:()=>C(n)},g);return c.useEffect(()=>{h.data&&u(h.data.ref_link)},[h]),c.useEffect(()=>{b&&l(b)},[b]),i.jsxs(i.Fragment,{children:[i.jsxs(N,{className:t.friends__section,className__title:t.friends__title,title:"Друзья",children:[i.jsxs("div",{className:t.friends__invite,children:[i.jsx("h2",{className:t.invite__title,children:"Играть вместе веселее!"}),i.jsx("p",{className:t.invite__label,children:"Получай награды за каждого друга, который присоединился"}),i.jsx("button",{className:t.invite__button,onClick:k,children:"Пригласить друга"})]}),i.jsxs("ul",{className:t.page__list,children:[_.map((m,j)=>i.jsx(f,{isOpen:d,friends:m,index:j,isDisabled:!1},m.tg_id)),_.length===0&&i.jsxs(i.Fragment,{children:[i.jsx(f,{friends:{name:"Name",points:"1.2kk",reg_data:"10.10.24",referral_bonus:!0,tg_id:"654651"},isDisabled:!0,index:0})," ",i.jsx(f,{friends:{name:"Name",points:"1.2kk",reg_data:"10.10.24",referral_bonus:!1,tg_id:"654651"},isDisabled:!0,index:1})," ",i.jsx(f,{friends:{name:"Name",points:"1.2kk",reg_data:"10.10.24",referral_bonus:!1,tg_id:"654651"},isDisabled:!0,index:2})]})]})]}),i.jsx(si,{isOpen:p,onClose:o,initialHeight:"70%",fullHeight:"70vh"})]})}export{fi as default};
