import{u as C,r as u,j as a,e as y,b as z}from"./index-DcRxAu3E.js";import{i as B,u as M}from"./coin-DniwYwRC.js";import{a as w,b as k,q as v}from"./queryClient-Cr7vBisK.js";import{u as $}from"./useMutation-DrhI0vlN.js";import{l as q}from"./logo-exXQDy5k.js";import{H}from"./HeaderCoinSvg-YTxrylCu.js";import{g as S}from"./getUser-DJBpJkua.js";import{S as P}from"./SlidingPanel-xHXvuc0U.js";const D="_catalog__section_p0z47_1",F="_catalog__header_p0z47_6",O="_reverse_p0z47_15",E="_catalog__button_p0z47_33",G="_catalog__image_p0z47_42",L="_catalog__list_p0z47_48",Q="_category__caption_p0z47_53",R="_catalog__title_p0z47_79",c={catalog__section:D,catalog__header:F,reverse:O,catalog__button:E,catalog__image:G,catalog__list:L,category__caption:Q,catalog__title:R};function T(t){return w.get(`${k}/api/shop/product-list/${t}/`,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}}).then(s=>s.data).catch(s=>{console.log(s)})}function U(t,s){return w.post(`${k}/api/shop/product-list/${t}/`,{product_id:s}).then(i=>i.data).catch(i=>{console.log(i)})}const K="_catalog__item_tie72_1",W="_catalog__upper_tie72_19",X="_catalog__price_tie72_24",Z="_catalog__info_tie72_34",A="_catalog__down_tie72_48",J="_catalog__img_tie72_54",V="_catalog__profession_tie72_63",Y="_catalog__prof_tie72_63",g={catalog__item:K,catalog__upper:W,catalog__price:X,catalog__info:Z,catalog__down:A,catalog__img:J,catalog__profession:V,catalog__prof:Y},I="/assets/iconBook-Dt4xzM-P.png",ss="/assets/sale5-BHXnLRWG.png",as="/assets/sale10-DNBte8BQ.png",p="/assets/useful_materials-Cfmv-Iql.png",j="/assets/miniCurs-DjvlySZB.png",ts="/assets/iconMerch-BICvc0cD.png",is=(t,s)=>{switch(t){case"Пройдите профтест на ....":return s(I);case"Cкидка 5% на все курсы":return s(ss);case"Cкидка 10% на все курсы":return s(as);case"Python-разработчик":return s(p);case"Бизнес-аналитик":return s(p);case"Веб-дизайнер":return s(p);case"40 правил идеального текста для соцсетей":return s(p);case"Как найти клиентов фрилансеру":return s(p);case"Введение в программирование":return s(j);case"Введение в маркетинг":return s(j);case"Введение в дизайн":return s(j);case"Эксклюзивная байка":return s(ts)}},es=t=>{if(typeof t=="number")return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},b=({id:t,name:s,price:i,description:l,prof:r,link:f,currentCoin:m,is_accessible:n})=>{const{tg_id:N}=C(),[x,_]=u.useState();u.useEffect(()=>{is(s,_)},[s]);const e=$({mutationFn:h=>U(h.tg_id,h.product_id),onSuccess:h=>{h.message==="Продукт успешно куплен"&&(window.location.href=f)}},v),o=()=>{n||m&&m>=+i&&e.mutate({tg_id:N,product_id:t})};return a.jsxs("li",{onClick:o,className:g.catalog__item,children:[a.jsxs("div",{className:g.catalog__upper,children:[a.jsxs("p",{style:{display:"flex",alignItems:"center",gap:"8px"},className:g.catalog__price,children:[i===0&&"Бесплатно",i!==0&&a.jsx("img",{width:43,height:43,src:B,alt:"coin"}),i!==0&&es(i)]}),i!==0&&a.jsx("p",{className:g.catalog__prof,children:r}),a.jsx("h2",{className:g.catalog__info,children:s})]}),a.jsx("span",{className:g.catalog__profession,children:l}),a.jsx("img",{className:g.catalog__img,src:x,alt:"предмет каталога"})]},t)},_s="_sliding__button_1fcgw_1",ns="_sliding__block_1fcgw_10",os="_sliding__image_1fcgw_23",cs="_sliding__title_1fcgw_27",ls="_sliding__label_1fcgw_35",rs="_sliding__span_1fcgw_46",gs="_sliding__money_1fcgw_55",ds="_sliding__coins_1fcgw_61",d={sliding__button:_s,sliding__block:ns,sliding__image:os,sliding__title:cs,sliding__label:ls,sliding__span:rs,sliding__money:gs,sliding__coins:ds},ps="/assets/sliding__catalog-d19G_n9M.webp",ms=({isOpen:t,onClose:s,initialHeight:i,fullHeight:l})=>{const r=y(S);return a.jsx(P,{darkened:!0,isOpen:t,onClose:s,initialHeight:i,fullHeight:l,children:a.jsxs("div",{className:d.sliding__block,children:[a.jsxs("div",{className:d.sliding__money,children:[a.jsx("img",{width:277,height:90,src:ps,alt:""}),a.jsx("span",{className:d.sliding__coins,children:r==null?void 0:r.points_all})]}),a.jsx("h2",{className:d.sliding__title,children:"У тебя есть баллы!"}),a.jsx("p",{className:d.sliding__label,children:"Обменяй их на бонусы в нашем магазине"}),a.jsx("p",{className:d.sliding__span,children:"*Важно: когда ты тратишь баллы в магазине, твой рейтинг в лидерборде не меняется!"}),a.jsx("button",{onClick:s,className:d.sliding__button,children:"Понятно"})]})})},ys=()=>{const{tg_id:t}=C(),s=y(S),[i,l]=u.useState(!1),r=z(),f=()=>{l(!1)},m=()=>{l(!0)},{data:n}=M({queryFn:()=>T(t),queryKey:["catalog"]},v),x=["Каталог","Скидки","Полезные материалы","Мини-курсы","Мерч"].filter(_=>_!=="Каталог");return a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:c.catalog__section,children:[a.jsxs("div",{className:c.catalog__header,children:[a.jsx("button",{onClick:m,className:c.catalog__button,children:"Информация"}),a.jsx("img",{width:69,height:15,className:c.catalog__image,src:q,alt:""}),a.jsxs("p",{onClick:()=>r("/tasks"),className:c.reverse,children:[a.jsx("span",{children:s==null?void 0:s.points}),a.jsx(H,{})]})]}),a.jsx("h1",{className:c.catalog__title,children:"Каталог"}),a.jsxs("ul",{className:c.catalog__list,children:[n==null?void 0:n.shops.filter(_=>_.name==="Каталог").map(_=>_.products.map(e=>a.jsx(b,{prof:e.description,id:e.id,name:e.name,link:e.link,currentCoin:s==null?void 0:s.points,price:e.price,description:_.description},e.id))),x.map(_=>a.jsxs(u.Fragment,{children:[a.jsx("li",{style:{margin:"30px 0"},children:a.jsx("h2",{className:c.category__caption,children:_})}),n==null?void 0:n.shops.filter(e=>e.name===_).map(e=>e.products.map(o=>a.jsx(b,{id:o.id,currentCoin:s==null?void 0:s.points,name:o.name,price:o.price,prof:o.description,description:e.description,link:o.link},o.id)))]},_))]})]}),a.jsx(ms,{fullHeight:"70vh",initialHeight:"70%",isOpen:i,onClose:f})]})};export{ys as default};
