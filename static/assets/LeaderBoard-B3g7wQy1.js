import{g as R,r as d,j as e,e as M,u as T}from"./index-CtK8AWOr.js";import{u as Y}from"./useQuery-Im5s0hMG.js";import{a as q,L as Z,b as z,P as B}from"./PageUI-BDakczl-.js";import{a as D,b as U,q as K}from"./queryClient-BkppHFvw.js";import{g as F}from"./getUser-DJBpJkua.js";function G(n){return D.get(`${U}/api/top100/${n}/`).then(a=>a.data).catch(a=>{console.log(a)})}const Q="_leader__section_d37jh_1",V="_leader__title_d37jh_6",A="_page__list_d37jh_16",f={leader__section:Q,leader__title:V,page__list:A},J="_slidingPanel_7nivp_1",W="_sliding_7nivp_1",X="_dragZone_7nivp_25",ee="_dragHandle_7nivp_32",te="_overlay_7nivp_44",ne="_panelContent_7nivp_53",ae="_darkened_7nivp_58",se="_visible_7nivp_66",ie="_expanded_7nivp_71",re="_bodyOpen_7nivp_75",o={slidingPanel:J,sliding:W,dragZone:X,dragHandle:ee,overlay:te,panelContent:ne,darkened:ae,visible:se,expanded:ie,bodyOpen:re};function oe(n,a={},s=[]){return[n,...s.filter(Boolean),...Object.entries(a).filter(([i])=>!!i).map(([i])=>i)].join(" ")}function de(n){const{children:a,element:s=document.body}=n;return R.createPortal(a,s)}function le(n){const{initialHeight:a,fullHeight:s,children:i,isOpen:t,onClose:r,darkened:c,className:w="",lazy:H,scrollLock:O}=n,[u,m]=d.useState("0"),y=d.useRef(null),x=d.useRef(0),j=d.useRef(0),p=d.useRef(),b=d.useRef(null),[P,C]=d.useState(!1),I=_=>{x.current=_.touches[0].clientY,j.current=parseInt(u),document.addEventListener("touchmove",v),document.addEventListener("touchend",h)},v=_=>{const N=x.current-_.touches[0].clientY,E=j.current+N;N>0?b.current="up":b.current="down",E>=parseInt(s)?m(s):E<=parseInt(a)&&m(a)},h=()=>{document.removeEventListener("touchmove",v),document.removeEventListener("touchend",h),parseInt(u)<=parseInt(a)&&b.current==="down"&&(m("0"),r&&(p.current=setTimeout(()=>{r()},300)))},k=_=>{_.key==="Escape"&&t&&r&&(p.current=setTimeout(()=>{r()},300))},L=()=>{t&&r&&(p.current=setTimeout(()=>{r()},300))},S=_=>{c&&_.target===y.current&&r()};d.useEffect(()=>(t&&(document.body.classList.add(o.bodyOpen),m(a),document.addEventListener("keydown",k),window.addEventListener("popstate",L)),()=>{clearTimeout(p.current),document.body.classList.remove(o.bodyOpen),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",h),document.removeEventListener("keydown",k),window.removeEventListener("popstate",L)}),[t]);const $={[o.visible]:t,[o.darkened]:t?c:!1};return d.useEffect(()=>{t&&C(!0)},[t]),H&&!P?null:e.jsx(de,{children:e.jsx("div",{ref:y,className:oe(o.slidingPanel,$,["app_modal",w]),onClick:S,style:c?{}:{height:t?u:"0",bottom:t?"0":`-${s}`,transition:"height 0.3s ease"},children:e.jsx("div",{className:o.sliding,style:c?{height:t?u:"0",bottom:t?"0":`-${s}`,transition:"height 0.3s ease"}:{},children:e.jsxs("div",{className:o.overlay,style:u==="50%"&&O?{overflowY:"hidden"}:{overflowY:"scroll"},children:[e.jsx("div",{onTouchStart:I,className:o.dragZone,children:e.jsx("div",{className:o.dragHandle})}),e.jsx("div",{className:o.panelContent,children:i})]})})})})}const _e="/assets/sliding__prize-B9vwOjVE.png",ce="_sliding__image_1vcyf_1",ue="_sliding__title_1vcyf_5",me="_sliding__label_1vcyf_15",pe="_sliding__button_1vcyf_24",g={sliding__image:ce,sliding__title:ue,sliding__label:me,sliding__button:pe},ge=({initialHeight:n,fullHeight:a,isOpen:s,onClose:i})=>e.jsxs(le,{initialHeight:n,fullHeight:a,isOpen:s,onClose:i,children:[e.jsx("img",{className:g.sliding__image,src:_e,alt:""}),e.jsx("h3",{className:g.sliding__title,children:"Супер-приз ждет тебя!"}),e.jsx("p",{className:g.sliding__label,children:"15 декабря игрок, который наберет наибольшее количество баллов, получит супер-приз — iPhone 16!"}),e.jsx("button",{onClick:i,className:g.sliding__button,children:"Ура!"})]}),be="_leaderboard__item_7pb5k_1",ve="_back_7pb5k_9",he="_leaderboard__avatar_7pb5k_13",fe="_leaderboard__name_7pb5k_19",ye="_leaderboard__coins_7pb5k_26",xe="_leaderboard__index_7pb5k_33",je="_leaderboard__svg_7pb5k_40",l={leaderboard__item:be,back:ve,leaderboard__avatar:he,leaderboard__name:fe,leaderboard__coins:ye,leaderboard__index:xe,leaderboard__svg:je},ke=({id:n,name:a,points:s,index:i})=>e.jsxs("li",{className:i<=3?`${l.back} ${l.leaderboard__item}`:l.leaderboard__item,children:[e.jsx("span",{className:l.leaderboard__index,children:i}),e.jsx("img",{className:l.leaderboard__avatar,src:q,alt:"avatar"}),i===1&&e.jsx(Z,{className:l.leaderboard__svg}),e.jsx("h2",{className:l.leaderboard__name,children:a}),e.jsx("p",{className:l.leaderboard__coins,children:s}),e.jsx(z,{})]},n),Oe=()=>{const n=M(F),{tg_id:a}=T(),[s,i]=d.useState(!1),{data:t}=Y({queryFn:()=>G(a),queryKey:["leaderboard"]},K);return e.jsxs(B,{className:f.leader__section,className__title:f.leader__title,place:t==null?void 0:t.player_rank,name:n==null?void 0:n.name,coins:n==null?void 0:n.points_all,gift:1,title:"Leaderboard",time:"До конца осталось: 12 дней 8 часов",isOpen:()=>i(!0),children:[e.jsx("ul",{className:f.page__list,children:t==null?void 0:t.top_players.map((r,c)=>e.jsx(ke,{index:c+1,id:r.tg_id,name:r.name,points:r.points},r.tg_id))}),e.jsx(ge,{fullHeight:"70",initialHeight:"30",isOpen:s,onClose:()=>i(!1)})]})};export{Oe as default};
