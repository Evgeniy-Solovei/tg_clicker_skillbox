import{u as k,j as s,r as f,e as v,b as M}from"./index-Dua1La-V.js";import{u as q}from"./useSuspenseQuery-eHZayzRh.js";import{a as w,b as O,q as F}from"./queryClient-DqqJVBrE.js";import{i as H}from"./coin-DCunUoSH.js";import{a as X,f as D}from"./formatNumber-B2gvpCqi.js";import{u as E}from"./useMutation-0GG5omXb.js";import{S}from"./SlidingPanel-DYYqFPC6.js";import{l as L}from"./logo-exXQDy5k.js";import{H as T}from"./HeaderCoinSvg-1JSBBqFI.js";import{g as B}from"./getUser-DJBpJkua.js";const Y="_catalog__section_164kj_1",G="_catalog__header_164kj_6",Q="_reverse_164kj_15",R="_catalog__button_164kj_33",U="_catalog__image_164kj_42",z="_catalog__list_164kj_48",K="_category__caption_164kj_52",W="_catalog__title_164kj_78",Z="_catalog__info1_164kj_87",A="_info__title_164kj_100",J="_info__label_164kj_108",o={catalog__section:Y,catalog__header:G,reverse:Q,catalog__button:R,catalog__image:U,catalog__list:z,category__caption:K,catalog__title:W,catalog__info1:Z,info__title:A,info__label:J};function V(n){return w.get(`${O}/api/shop/product-list/${n}/`,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}}).then(i=>i.data).catch(i=>{console.log(i)})}function I(n,i){return w.post(`${O}/api/shop/product-list/${n}/`,{product_id:i}).then(a=>a.data).catch(a=>{console.log(a)})}const ss="_catalog__item_10tiw_1",is="_catalog__upper_10tiw_19",ts="_catalog__price_10tiw_24",as="_catalog__info_10tiw_34",es="_catalog__down_10tiw_48",ns="_catalog__img_10tiw_54",_s="_catalog__profession_10tiw_63",cs="_catalog__prof_10tiw_63",ls="_catalog_compl_btn_10tiw_87",m={catalog__item:ss,catalog__upper:is,catalog__price:ts,catalog__info:as,catalog__down:es,catalog__img:ns,catalog__profession:_s,catalog__prof:cs,catalog_compl_btn:ls},os="/assets/iconBook-Dt4xzM-P.png",rs="/assets/sale5-BHXnLRWG.png",ds="/assets/sale10-DNBte8BQ.png",x="/assets/useful_materials-Cfmv-Iql.png",N="/assets/miniCurs-DjvlySZB.png",gs="/assets/iconMerch-BICvc0cD.png",ms=(n,i)=>{switch(n){case"Пройдите профтест на ....":return i(os);case"Cкидка 5% на все курсы":return i(rs);case"Cкидка 10% на все курсы":return i(ds);case"Python-разработчик":return i(x);case"Бизнес-аналитик":return i(x);case"Веб-дизайнер":return i(x);case"40 правил идеального текста для соцсетей":return i(x);case"Как найти клиентов фрилансеру":return i(x);case"Введение в программирование":return i(N);case"Введение в маркетинг":return i(N);case"Введение в дизайн":return i(N);case"Эксклюзивная байка":return i(gs)}},ps="_sliding__block_15i9u_1",us="_name_title_15i9u_14",hs="_name_title_not_15i9u_23",fs="_sliding_product_btn_buy_15i9u_33",bs="_promo_15i9u_48",js="_sliding_product_btn_promo_15i9u_58",d={sliding__block:ps,name_title:us,name_title_not:hs,sliding_product_btn_buy:fs,promo:bs,sliding_product_btn_promo:js};function xs({isOpen:n,onClose:i,initialHeight:a,fullHeight:g,product:t}){const{tg:c,tg_id:h}=k(),p=e=>{c.openLink(e,{try_instant_vew:!0})},l=E({mutationFn:e=>I(e.tg_id,e.product_id),onSuccess:e=>{e.message==="Продукт успешно куплен"&&p(t.link)},onError:()=>{i(),c.HapticFeedback.impactOccurred("medium")}},F),b=()=>{l.mutate({tg_id:h,product_id:t.id}),c.HapticFeedback.impactOccurred("medium")},j=()=>{if(!t.is_accessible)l.mutate({tg_id:h,product_id:t.id}),c.HapticFeedback.impactOccurred("medium");else return},_=()=>{navigator.clipboard.writeText("555"),c.HapticFeedback.impactOccurred("heavy")};return s.jsx(S,{darkened:!0,isOpen:n,onClose:i,initialHeight:a,fullHeight:g,children:s.jsxs("div",{className:d.sliding__block,children:[t.currentCoin&&t.price!==0&&t.currentCoin>=+t.price?s.jsxs(s.Fragment,{children:[t.id=="4"||t.id=="5"?s.jsxs("p",{className:d.promo,children:[t.id=="4"&&"BOXY5",t.id=="5"&&"BOXY10"]}):null,s.jsx("p",{className:d.name_title,children:t.name}),t.id=="4"||t.id=="5"?s.jsx("button",{onClick:_,className:d.sliding_product_btn_promo,children:"Скопировать промокод"}):null,s.jsx("button",{onClick:j,className:t.id=="4"||t.id=="5"?d.sliding_product_btn_promo:d.sliding_product_btn_buy,children:t.id=="4"||t.id=="5"?"Активировать":"Купить"})]}):t.price!==0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:d.name_title_not,children:"Недостаточно баллов!"}),s.jsx("img",{width:60,src:H,alt:""}),s.jsx("button",{onClick:()=>i(),className:d.sliding_product_btn_buy,children:"Назад"})]}),t.price===0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:d.name_title,children:t.name}),s.jsx("button",{onClick:b,className:d.sliding_product_btn_buy,children:"Пройти"})]})]})})}const C=f.memo(({id:n,name:i,price:a,description:g,prof:t,link:c,currentCoin:h,is_accessible:p,is_purchased:l})=>{const{tg:b}=k(),[j,_]=f.useState(),e={id:n,name:i,price:a,description:g,prof:t,is_accessible:p,link:c,currentCoin:h,is_purchased:l},[r,y]=f.useState(!1);f.useEffect(()=>{ms(i,_),console.log(p)},[i]);const P=()=>{if(!p)y(!0),b.HapticFeedback.impactOccurred("medium");else return},$=()=>{y(!1),b.HapticFeedback.impactOccurred("medium")};return s.jsxs(s.Fragment,{children:[s.jsxs("li",{onClick:P,className:m.catalog__item,children:[s.jsxs("div",{className:m.catalog__upper,children:[p===!0?s.jsx(s.Fragment,{children:n=="4"||n=="5"?s.jsxs("p",{className:m.catalog__price,children:[e.id=="4"&&"BOXY5",e.id=="5"&&"BOXY10"]}):s.jsx("button",{disabled:!0,className:m.catalog_compl_btn,children:"Приобретено"})}):s.jsxs("p",{style:{display:"flex",alignItems:"center",gap:"8px"},className:m.catalog__price,children:[a===0&&"Бесплатно",a!==0&&s.jsx("img",{width:43,height:43,src:H,alt:"coin"}),a!==0&&X(a)]}),a!==0&&s.jsx("p",{className:m.catalog__prof,children:t}),s.jsx("h2",{className:m.catalog__info,children:i})]}),s.jsx("span",{className:m.catalog__profession,children:g}),s.jsx("img",{className:m.catalog__img,src:j,alt:"предмет каталога"})]},n),s.jsx(xs,{onClose:$,isOpen:r,initialHeight:"70%",fullHeight:"70vh",product:e})]})}),ks="_sliding__button_10f51_1",Ns="_sliding__block_10f51_11",ys="_sliding__image_10f51_24",Cs="_sliding__title_10f51_28",vs="_sliding__label_10f51_36",ws="_sliding__span_10f51_47",Os="_sliding__money_10f51_56",Fs="_sliding__coins_10f51_62",u={sliding__button:ks,sliding__block:Ns,sliding__image:ys,sliding__title:Cs,sliding__label:vs,sliding__span:ws,sliding__money:Os,sliding__coins:Fs},Hs="/assets/sliding__catalog-d19G_n9M.webp",Ss=({isOpen:n,onClose:i,initialHeight:a,fullHeight:g})=>{const t=v(B),{tg:c}=k();return s.jsx(S,{darkened:!0,isOpen:n,onClose:i,initialHeight:a,fullHeight:g,children:s.jsxs("div",{className:u.sliding__block,children:[s.jsxs("div",{className:u.sliding__money,children:[s.jsx("img",{width:277,height:90,src:Hs,alt:""}),s.jsx("span",{className:u.sliding__coins,children:t==null?void 0:t.points_all})]}),s.jsx("h2",{className:u.sliding__title,children:"У тебя есть баллы!"}),s.jsx("p",{className:u.sliding__label,children:"Обменяй их на бонусы в нашем магазине"}),s.jsx("p",{className:u.sliding__span,children:"*Важно: когда ты тратишь баллы в магазине, твой рейтинг в лидерборде не меняется!"}),s.jsx("button",{onClick:()=>{i(),c.HapticFeedback.impactOccurred("medium")},className:u.sliding__button,children:"Понятно"})]})})},Ys=()=>{const{tg:n,tg_id:i}=k(),a=v(B),[g,t]=f.useState(!1),c=M(),h=()=>{t(!1),n.HapticFeedback.impactOccurred("medium")},p=()=>{t(!0),n.HapticFeedback.impactOccurred("medium")},{data:l}=q({queryFn:()=>V(i),queryKey:["catalog"]},F),j=["Каталог","Скидки","Полезные материалы","Мини-курсы","Мерч"].filter(_=>_!=="Каталог");return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:o.catalog__section,children:[s.jsxs("div",{className:o.catalog__header,children:[s.jsx("button",{onClick:p,className:o.catalog__button,children:"Информация"}),s.jsx("img",{width:69,height:15,className:o.catalog__image,src:L,alt:""}),s.jsxs("p",{onClick:()=>c("/tasks"),className:o.reverse,children:[s.jsx("span",{children:a&&D(a.points)}),s.jsx(T,{})]})]}),s.jsx("h1",{className:o.catalog__title,children:"Каталог"}),s.jsxs("div",{className:o.catalog__info1,children:[s.jsx("h2",{className:o.info__title,children:"Тапай и копи баллы!"}),s.jsx("p",{className:o.info__label,children:"Чтобы выиграть IPhone или получить мерч"})]}),s.jsxs("ul",{className:o.catalog__list,children:[l==null?void 0:l.shops.filter(_=>_.name==="Каталог").map(_=>_.products.map(e=>s.jsx(C,{prof:e.description,id:e.id,name:e.name,link:e.link,currentCoin:a==null?void 0:a.points,price:e.price,description:_.description,is_accessible:e.is_accessible,is_purchased:e.is_purchased},e.id))),j.map(_=>s.jsxs(f.Fragment,{children:[s.jsx("li",{style:{margin:"30px 0"},children:s.jsx("h2",{className:o.category__caption,children:_})}),l==null?void 0:l.shops.filter(e=>e.name===_).map(e=>e.products.map(r=>s.jsx(C,{id:r.id,currentCoin:a==null?void 0:a.points,name:r.name,price:r.price,prof:r.description,description:e.description,link:r.link,is_accessible:r.is_accessible,is_purchased:r.is_purchased},r.id)))]},_))]})]}),s.jsx(Ss,{fullHeight:"70vh",initialHeight:"70%",isOpen:g,onClose:h})]})};export{Ys as default};
