import{u as k,j as s,r as x,e as v,b as $}from"./index-Bo-eR_JQ.js";import{i as O,u as M}from"./coin-BpkcyZK3.js";import{a as F,b as H,q as B}from"./queryClient-DzN13fHD.js";import{u as q}from"./useMutation-CvrEcQzQ.js";import{S}from"./SlidingPanel-FiPemMas.js";import{l as X}from"./logo-exXQDy5k.js";import{H as D}from"./HeaderCoinSvg-BSC_LbVA.js";import{g as w}from"./getUser-DJBpJkua.js";const E="_catalog__section_164kj_1",T="_catalog__header_164kj_6",Y="_reverse_164kj_15",G="_catalog__button_164kj_33",L="_catalog__image_164kj_42",Q="_catalog__list_164kj_48",R="_category__caption_164kj_52",U="_catalog__title_164kj_78",K="_catalog__info1_164kj_87",W="_info__title_164kj_100",Z="_info__label_164kj_108",l={catalog__section:E,catalog__header:T,reverse:Y,catalog__button:G,catalog__image:L,catalog__list:Q,category__caption:R,catalog__title:U,catalog__info1:K,info__title:W,info__label:Z};function A(t){return F.get(`${H}/api/shop/product-list/${t}/`,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}}).then(a=>a.data).catch(a=>{console.log(a)})}function J(t,a){return F.post(`${H}/api/shop/product-list/${t}/`,{product_id:a}).then(i=>i.data).catch(i=>{console.log(i)})}const V="_catalog__item_1lzem_1",I="_catalog__upper_1lzem_19",ss="_catalog__price_1lzem_24",as="_catalog__info_1lzem_34",es="_catalog__down_1lzem_48",is="_catalog__img_1lzem_54",ts="_catalog__profession_1lzem_63",ns="_catalog__prof_1lzem_63",_s="_catalog_compl_btn_1lzem_87",p={catalog__item:V,catalog__upper:I,catalog__price:ss,catalog__info:as,catalog__down:es,catalog__img:is,catalog__profession:ts,catalog__prof:ns,catalog_compl_btn:_s},cs="/assets/iconBook-Dt4xzM-P.png",ls="/assets/sale5-BHXnLRWG.png",os="/assets/sale10-DNBte8BQ.png",j="/assets/useful_materials-Cfmv-Iql.png",N="/assets/miniCurs-DjvlySZB.png",rs="/assets/iconMerch-BICvc0cD.png",ds=(t,a)=>{switch(t){case"Пройдите профтест на ....":return a(cs);case"Cкидка 5% на все курсы":return a(ls);case"Cкидка 10% на все курсы":return a(os);case"Python-разработчик":return a(j);case"Бизнес-аналитик":return a(j);case"Веб-дизайнер":return a(j);case"40 правил идеального текста для соцсетей":return a(j);case"Как найти клиентов фрилансеру":return a(j);case"Введение в программирование":return a(N);case"Введение в маркетинг":return a(N);case"Введение в дизайн":return a(N);case"Эксклюзивная байка":return a(rs)}},gs=t=>{if(typeof t=="number")return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},ms="_sliding__block_15i9u_1",ps="_name_title_15i9u_14",us="_name_title_not_15i9u_23",hs="_sliding_product_btn_buy_15i9u_33",bs="_promo_15i9u_48",fs="_sliding_product_btn_promo_15i9u_58",d={sliding__block:ms,name_title:ps,name_title_not:us,sliding_product_btn_buy:hs,promo:bs,sliding_product_btn_promo:fs};function js({isOpen:t,onClose:a,initialHeight:i,fullHeight:g,product:e}){const{tg:c,tg_id:h}=k(),m=q({mutationFn:n=>J(n.tg_id,n.product_id),onSuccess:n=>{n.message==="Продукт успешно куплен"&&(window.location.href=e.link,c.HapticFeedback.impactOccurred("medium"))},onError:()=>{a(),c.HapticFeedback.impactOccurred("medium")}},B),o=()=>{m.mutate({tg_id:h,product_id:e.id}),c.HapticFeedback.impactOccurred("medium")},b=()=>{if(!e.is_accessible)m.mutate({tg_id:h,product_id:e.id}),c.HapticFeedback.impactOccurred("medium");else return},f=()=>{navigator.clipboard.writeText("555"),c.HapticFeedback.impactOccurred("heavy")};return s.jsx(S,{darkened:!0,isOpen:t,onClose:a,initialHeight:i,fullHeight:g,children:s.jsxs("div",{className:d.sliding__block,children:[e.currentCoin&&e.price!==0&&e.currentCoin>=+e.price?s.jsxs(s.Fragment,{children:[e.id=="4"||e.id=="5"?s.jsxs("p",{className:d.promo,children:[e.id=="4"&&"BOXY5",e.id=="5"&&"BOXY10"]}):null,s.jsx("p",{className:d.name_title,children:e.name}),e.id=="4"||e.id=="5"?s.jsx("button",{onClick:f,className:d.sliding_product_btn_promo,children:"Скопировать промокод"}):null,s.jsx("button",{onClick:b,className:e.id=="4"||e.id=="5"?d.sliding_product_btn_promo:d.sliding_product_btn_buy,children:e.id=="4"||e.id=="5"?"Активировать":"Купить"})]}):e.price!==0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:d.name_title_not,children:"Недостаточно баллов!"}),s.jsx("img",{width:60,src:O,alt:""}),s.jsx("button",{onClick:()=>a(),className:d.sliding_product_btn_buy,children:"Назад"})]}),e.price===0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:d.name_title,children:e.name}),s.jsx("button",{onClick:o,className:d.sliding_product_btn_buy,children:"Пройти"})]})]})})}const C=({id:t,name:a,price:i,description:g,prof:e,link:c,currentCoin:h,is_accessible:m,is_purchased:o})=>{const{tg:b}=k(),[f,n]=x.useState(),_={id:t,name:a,price:i,description:g,prof:e,is_accessible:m,link:c,currentCoin:h,is_purchased:o},[r,y]=x.useState(!1);x.useEffect(()=>{ds(a,n),console.log(m)},[a]);const z=()=>{if(!m)y(!0),b.HapticFeedback.impactOccurred("medium");else return},P=()=>{y(!1),b.HapticFeedback.impactOccurred("medium")};return s.jsxs(s.Fragment,{children:[s.jsxs("li",{onClick:z,className:p.catalog__item,children:[s.jsxs("div",{className:p.catalog__upper,children:[m===!0?s.jsx(s.Fragment,{children:t=="4"||t=="5"?s.jsxs("p",{className:p.catalog__price,children:[_.id=="4"&&"BOXY5",_.id=="5"&&"BOXY10"]}):s.jsx("button",{disabled:!0,className:p.catalog_compl_btn,children:"Приобретено"})}):s.jsxs("p",{style:{display:"flex",alignItems:"center",gap:"8px"},className:p.catalog__price,children:[i===0&&"Бесплатно",i!==0&&s.jsx("img",{width:43,height:43,src:O,alt:"coin"}),i!==0&&gs(i)]}),i!==0&&s.jsx("p",{className:p.catalog__prof,children:e}),s.jsx("h2",{className:p.catalog__info,children:a})]}),s.jsx("span",{className:p.catalog__profession,children:g}),s.jsx("img",{className:p.catalog__img,src:f,alt:"предмет каталога"})]},t),s.jsx(js,{onClose:P,isOpen:r,initialHeight:"70%",fullHeight:"70vh",product:_})]})},xs="_sliding__button_10f51_1",ks="_sliding__block_10f51_11",Ns="_sliding__image_10f51_24",ys="_sliding__title_10f51_28",Cs="_sliding__label_10f51_36",vs="_sliding__span_10f51_47",Os="_sliding__money_10f51_56",Fs="_sliding__coins_10f51_62",u={sliding__button:xs,sliding__block:ks,sliding__image:Ns,sliding__title:ys,sliding__label:Cs,sliding__span:vs,sliding__money:Os,sliding__coins:Fs},Hs="/assets/sliding__catalog-d19G_n9M.webp",Bs=({isOpen:t,onClose:a,initialHeight:i,fullHeight:g})=>{const e=v(w),{tg:c}=k();return s.jsx(S,{darkened:!0,isOpen:t,onClose:a,initialHeight:i,fullHeight:g,children:s.jsxs("div",{className:u.sliding__block,children:[s.jsxs("div",{className:u.sliding__money,children:[s.jsx("img",{width:277,height:90,src:Hs,alt:""}),s.jsx("span",{className:u.sliding__coins,children:e==null?void 0:e.points_all})]}),s.jsx("h2",{className:u.sliding__title,children:"У тебя есть баллы!"}),s.jsx("p",{className:u.sliding__label,children:"Обменяй их на бонусы в нашем магазине"}),s.jsx("p",{className:u.sliding__span,children:"*Важно: когда ты тратишь баллы в магазине, твой рейтинг в лидерборде не меняется!"}),s.jsx("button",{onClick:()=>{a(),c.HapticFeedback.impactOccurred("medium")},className:u.sliding__button,children:"Понятно"})]})})},Ds=()=>{const{tg:t,tg_id:a}=k(),i=v(w),[g,e]=x.useState(!1),c=$(),h=()=>{e(!1),t.HapticFeedback.impactOccurred("medium")},m=()=>{e(!0),t.HapticFeedback.impactOccurred("medium")},{data:o}=M({queryFn:()=>A(a),queryKey:["catalog"]},B),f=["Каталог","Скидки","Полезные материалы","Мини-курсы","Мерч"].filter(n=>n!=="Каталог");return s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:l.catalog__section,children:[s.jsxs("div",{className:l.catalog__header,children:[s.jsx("button",{onClick:m,className:l.catalog__button,children:"Информация"}),s.jsx("img",{width:69,height:15,className:l.catalog__image,src:X,alt:""}),s.jsxs("p",{onClick:()=>c("/tasks"),className:l.reverse,children:[s.jsx("span",{children:i==null?void 0:i.points}),s.jsx(D,{})]})]}),s.jsx("h1",{className:l.catalog__title,children:"Каталог"}),s.jsxs("div",{className:l.catalog__info1,children:[s.jsx("h2",{className:l.info__title,children:"Тапай и копи баллы!"}),s.jsx("p",{className:l.info__label,children:"Чтобы выиграть IPhone или получить мерч"})]}),s.jsxs("ul",{className:l.catalog__list,children:[o==null?void 0:o.shops.filter(n=>n.name==="Каталог").map(n=>n.products.map(_=>s.jsx(C,{prof:_.description,id:_.id,name:_.name,link:_.link,currentCoin:i==null?void 0:i.points,price:_.price,description:n.description,is_accessible:_.is_accessible,is_purchased:_.is_purchased},_.id))),f.map(n=>s.jsxs(x.Fragment,{children:[s.jsx("li",{style:{margin:"30px 0"},children:s.jsx("h2",{className:l.category__caption,children:n})}),o==null?void 0:o.shops.filter(_=>_.name===n).map(_=>_.products.map(r=>s.jsx(C,{id:r.id,currentCoin:i==null?void 0:i.points,name:r.name,price:r.price,prof:r.description,description:_.description,link:r.link,is_accessible:r.is_accessible,is_purchased:r.is_purchased},r.id)))]},n))]})]}),s.jsx(Bs,{fullHeight:"70vh",initialHeight:"70%",isOpen:g,onClose:h})]})};export{Ds as default};
